{
  "ml_parser_test_cases": [
    {
      "name": "Simple syslog",
      "description": "Basic syslog format with timestamps and log levels",
      "lines": [
        "2024-06-01 12:00:00 INFO Started system",
        "2024-06-01 12:01:00 ERROR Disk full",
        "2024-06-01 12:02:00 WARN High memory usage: 85%",
        "2024-06-01 12:03:00 DEBUG Debugging info here",
        "2024-06-01 12:04:00 FATAL Kernel panic: system halted"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "Started system"
        },
        {
          "level": "ERROR",
          "message_contains": "Disk full"
        },
        {
          "level": "WARN",
          "message_contains": "High memory usage"
        },
        {
          "level": "DEBUG",
          "message_contains": "Debugging info"
        },
        {
          "level": "FATAL",
          "message_contains": "Kernel panic"
        }
      ]
    },
    {
      "name": "Apache access log",
      "description": "Apache/Nginx access log format with IP addresses and HTTP requests",
      "lines": [
        "127.0.0.1 - - [01/Jun/2024:12:00:00 +0000] \"GET /index.html HTTP/1.1\" 200 2326",
        "127.0.0.1 - - [01/Jun/2024:12:01:00 +0000] \"POST /login HTTP/1.1\" 401 512",
        "127.0.0.1 - - [01/Jun/2024:12:02:00 +0000] \"GET /api/data HTTP/1.1\" 500 890",
        "127.0.0.1 - - [01/Jun/2024:12:03:00 +0000] \"PUT /api/update HTTP/1.1\" 200 234",
        "127.0.0.1 - - [01/Jun/2024:12:04:00 +0000] \"DELETE /api/delete HTTP/1.1\" 404 123"
      ],
      "expect": [
        {
          "message_contains": "/index.html"
        },
        {
          "message_contains": "/login"
        },
        {
          "message_contains": "/api/data"
        },
        {
          "message_contains": "/api/update"
        },
        {
          "message_contains": "/api/delete"
        }
      ]
    },
    {
      "name": "Unstructured error",
      "description": "Unstructured error messages without clear timestamps or levels",
      "lines": [
        "Something went wrong at 12:02:00!",
        "Critical failure in module X",
        "Disk is almost full!",
        "User not found: john.doe",
        "Timeout occurred while connecting to database"
      ],
      "expect": [
        {
          "message_contains": "Something went wrong"
        },
        {
          "message_contains": "Critical failure"
        },
        {
          "message_contains": "Disk is almost full"
        },
        {
          "message_contains": "User not found"
        },
        {
          "message_contains": "Timeout occurred"
        }
      ]
    },
    {
      "name": "Kubernetes log",
      "description": "Kubernetes pod and container logs with structured format",
      "lines": [
        "2024-06-01T12:03:00Z pod1 container1 ERROR CrashLoopBackOff",
        "2024-06-01T12:03:01Z pod2 container2 WARN Resource limits approaching",
        "2024-06-01T12:03:02Z pod3 container3 INFO Pod started",
        "2024-06-01T12:03:03Z pod1 container1 DEBUG Health check running",
        "2024-06-01T12:03:04Z pod2 container2 ERROR Service discovery failed"
      ],
      "expect": [
        {
          "level": "ERROR",
          "message_contains": "CrashLoopBackOff"
        },
        {
          "level": "WARN",
          "message_contains": "Resource limits"
        },
        {
          "level": "INFO",
          "message_contains": "Pod started"
        },
        {
          "level": "DEBUG",
          "message_contains": "Health check"
        },
        {
          "level": "ERROR",
          "message_contains": "Service discovery"
        }
      ]
    },
    {
      "name": "Security log",
      "description": "Security-related logs with authentication and access attempts",
      "lines": [
        "2024-06-01T12:04:00Z SECURITY WARN Unauthorized access from 10.0.0.1",
        "2024-06-01T12:04:01Z SECURITY INFO Successful authentication: user=admin",
        "2024-06-01T12:04:02Z SECURITY ERROR Unauthorized access attempt: resource=/admin",
        "2024-06-01T12:04:03Z SECURITY INFO Password changed: user=john",
        "2024-06-01T12:04:04Z SECURITY WARN Multiple failed attempts: user=guest"
      ],
      "expect": [
        {
          "level": "WARN",
          "message_contains": "Unauthorized access"
        },
        {
          "level": "INFO",
          "message_contains": "Successful authentication"
        },
        {
          "level": "ERROR",
          "message_contains": "Unauthorized access attempt"
        },
        {
          "level": "INFO",
          "message_contains": "Password changed"
        },
        {
          "level": "WARN",
          "message_contains": "Multiple failed attempts"
        }
      ]
    },
    {
      "name": "Stack trace multiline",
      "description": "Multi-line stack traces that should be stitched together",
      "lines": [
        "2024-06-01 12:05:00 ERROR Exception in thread main",
        "Traceback (most recent call last):",
        "  File \"main.py\", line 1, in <module>",
        "    raise Exception('fail')",
        "Exception: fail",
        "2024-06-01 12:05:01 ERROR Another error occurred",
        "Traceback (most recent call last):",
        "  File \"worker.py\", line 10, in <module>",
        "    do_work()",
        "RuntimeError: work failed"
      ],
      "expect": [
        {
          "level": "ERROR",
          "message_contains": "Exception in thread main"
        },
        {
          "level": "ERROR",
          "message_contains": "Traceback"
        }
      ]
    },
    {
      "name": "JSON logs",
      "description": "Structured JSON logs with embedded timestamps and levels",
      "lines": [
        "{\"timestamp\":\"2024-06-01T12:00:00Z\",\"level\":\"INFO\",\"message\":\"System started\",\"user\":\"admin\"}",
        "{\"timestamp\":\"2024-06-01T12:01:00Z\",\"level\":\"WARN\",\"message\":\"High memory usage\",\"memory_percent\":85}",
        "{\"timestamp\":\"2024-06-01T12:02:00Z\",\"level\":\"ERROR\",\"message\":\"Database error\",\"error_code\":\"DB001\"}",
        "{\"timestamp\":\"2024-06-01T12:03:00Z\",\"level\":\"INFO\",\"message\":\"Request processed\",\"duration\":150}",
        "{\"timestamp\":\"2024-06-01T12:04:00Z\",\"level\":\"DEBUG\",\"message\":\"Cache miss\",\"key\":\"user_123\"}"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "System started"
        },
        {
          "level": "WARN",
          "message_contains": "High memory usage"
        },
        {
          "level": "ERROR",
          "message_contains": "Database error"
        },
        {
          "level": "INFO",
          "message_contains": "Request processed"
        },
        {
          "level": "DEBUG",
          "message_contains": "Cache miss"
        }
      ]
    },
    {
      "name": "Malformed JSON and mixed",
      "description": "Mixed content with malformed JSON and unstructured lines",
      "lines": [
        "{\"timestamp\":\"2024-06-01T12:00:00Z\",\"level\":\"INFO\",\"message\":\"Good JSON\"}",
        "{\"timestamp\":\"2024-06-01T12:01:00Z\",\"level\":\"WARN\",\"message\":\"Missing end brace\"",
        "{\"timestamp\":\"2024-06-01T12:02:00Z\",\"level\":\"ERROR\",\"message\":\"Extra comma\",}",
        "{timestamp:2024-06-01T12:03:00Z,level:INFO,message:\"Unquoted keys\"}",
        "{\"timestamp\":\"2024-06-01T12:04:00Z\",\"level\":\"DEBUG\",\"message\":\"Trailing comma\",}",
        "2024-06-01 12:04:01 INFO Not JSON at all",
        "Random unstructured line"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "Good JSON"
        },
        {
          "message_contains": "Missing end brace"
        },
        {
          "message_contains": "Extra comma"
        },
        {
          "message_contains": "Unquoted keys"
        },
        {
          "message_contains": "Trailing comma"
        },
        {
          "level": "INFO",
          "message_contains": "Not JSON at all"
        },
        {
          "message_contains": "Random unstructured"
        }
      ]
    },
    {
      "name": "Mixed log types",
      "description": "Mixed log formats in a single file",
      "lines": [
        "2024-06-01 12:00:00 INFO Started system",
        "{\"timestamp\":\"2024-06-01T12:01:00Z\",\"level\":\"WARN\",\"message\":\"High memory usage\"}",
        "127.0.0.1 - - [01/Jun/2024:12:02:00 +0000] \"GET /api/data HTTP/1.1\" 500 890",
        "2024-06-01T12:03:00Z pod1 container1 ERROR CrashLoopBackOff",
        "Something went wrong at 12:04:00!",
        "2024-06-01T12:05:00Z SECURITY INFO Successful authentication: user=admin",
        "{\"timestamp\":\"2024-06-01T12:06:00Z\",\"level\":\"DEBUG\",\"message\":\"Cache miss\"}"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "Started system"
        },
        {
          "level": "WARN",
          "message_contains": "High memory usage"
        },
        {
          "message_contains": "/api/data"
        },
        {
          "level": "ERROR",
          "message_contains": "CrashLoopBackOff"
        },
        {
          "message_contains": "Something went wrong"
        },
        {
          "level": "INFO",
          "message_contains": "Successful authentication"
        },
        {
          "level": "DEBUG",
          "message_contains": "Cache miss"
        }
      ]
    },
    {
      "name": "Edge cases and empty lines",
      "description": "Edge cases including empty lines, malformed content, and partial data",
      "lines": [
        "",
        "   ",
        "2024-06-01 12:00:00 INFO Only one field",
        "{\"message\":\"No timestamp or level\"}",
        "2024-06-01 12:01:00",
        "ERROR: Something bad happened",
        "2024-06-01 12:02:00 FATAL",
        "Just a message"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "Only one field"
        },
        {
          "message_contains": "No timestamp or level"
        },
        {
          "message_contains": "2024-06-01 12:01:00"
        },
        {
          "message_contains": "ERROR: Something bad happened"
        },
        {
          "level": "FATAL",
          "message_contains": "2024-06-01 12:02:00"
        },
        {
          "message_contains": "Just a message"
        }
      ]
    },
    {
      "category": "ml_parser_test_cases",
      "name": "Docker Container Logs",
      "description": "Docker container logs with timestamps and structured format",
      "lines": [
        "2024-06-01T12:00:00.123Z container1 INFO Container started successfully",
        "2024-06-01T12:00:01.456Z container2 WARN High CPU usage: 90%",
        "2024-06-01T12:00:02.789Z container3 ERROR Out of memory exception",
        "2024-06-01T12:00:03.012Z container1 INFO Health check passed",
        "2024-06-01T12:00:04.345Z container2 DEBUG Processing request: /api/data"
      ],
      "expect": [
        {
          "level": "INFO",
          "message_contains": "Container started"
        },
        {
          "level": "WARN",
          "message_contains": "High CPU usage"
        },
        {
          "level": "ERROR",
          "message_contains": "Out of memory"
        },
        {
          "level": "INFO",
          "message_contains": "Health check passed"
        },
        {
          "level": "DEBUG",
          "message_contains": "Processing request"
        }
      ]
    },
    {
      "name": "Malformed and Corrupted Logs",
      "description": "Logs with incomplete JSON, broken lines, and encoding issues.",
      "lines": [
        "{\"timestamp\":\"2024-06-01T12:00:00Z\",\"level\":\"INFO\",\"message\":\"Good JSON\"}",
        "{\"timestamp\":\"2024-06-01T12:01:00Z\",\"level\":\"WARN\",\"message\":\"Missing end brace\"",
        "2024-06-01 12:02:00 INFO Normal line after binary",
        "{\"timestamp\":\"2024-06-01T12:03:00Z\",\"level\":\"ERROR\",\"message\":\"Corrupted \uFFFD character\"}",
        "2024-06-01 12:04:00 INFO Line with bad encoding: caf\\xe9",
        "2024-06-01 12:05:00 INFO Incomplete",
        "2024-06-01 12:06:00 INFO \u0007Bell character in log"
      ],
      "expect": [
        { "level": "INFO", "message_contains": "Good JSON" },
        { "message_contains": "Missing end brace" },
        { "message_contains": "Normal line after binary" },
        { "level": "ERROR", "message_contains": "Corrupted" },
        { "message_contains": "bad encoding" },
        { "message_contains": "Incomplete" },
        { "message_contains": "Bell character" }
      ]
    },
    {
      "name": "Internationalization and Unicode",
      "description": "Logs with non-ASCII characters, emojis, right-to-left scripts, and mixed languages.",
      "lines": [
        "2024-06-01 12:00:00 INFO User café visited from 北京",
        "2024-06-01 12:01:00 WARN 🚨 System alert: CPU usage high 🔥",
        "2024-06-01 12:02:00 ERROR خطأ في النظام: فشل الاتصال",
        "2024-06-01 12:03:00 INFO ユーザーがログインしました: 田中太郎",
        "2024-06-01 12:04:00 DEBUG Mixed: café + 北京 + 🚨 + خطأ + ユーザー",
        "{\"timestamp\":\"2024-06-01T12:05:00Z\",\"level\":\"INFO\",\"message\":\"Unicode JSON: café 🚨 北京 خطأ ユーザー\"}"
      ],
      "expect": [
        { "level": "INFO", "message_contains": "café" },
        { "level": "WARN", "message_contains": "🚨" },
        { "level": "ERROR", "message_contains": "خطأ" },
        { "level": "INFO", "message_contains": "ユーザー" },
        { "level": "DEBUG", "message_contains": "Mixed" },
        { "level": "INFO", "message_contains": "Unicode JSON" }
      ]
    },
    {
      "name": "Timestamp and Level Oddities",
      "description": "Logs with missing timestamps, duplicate timestamps, out-of-order timestamps, unknown log levels, and lowercase/strange log levels.",
      "lines": [
        "INFO Started system with no timestamp",
        "2024-06-01 12:00:00 INFO Normal entry",
        "2024-06-01 12:00:00 INFO Duplicate timestamp",
        "2024-06-01 11:59:59 WARN Out-of-order timestamp",
        "2024-06-01 12:01:00 UNKNOWN Something weird happened",
        "2024-06-01 12:02:00 info lowercase level",
        "2024-06-01 12:03:00 CRIT Critical error occurred",
        "2024-06-01 12:04:00 fatal System halted"
      ],
      "expect": [
        { "message_contains": "no timestamp" },
        { "level": "INFO", "message_contains": "Normal entry" },
        { "level": "INFO", "message_contains": "Duplicate timestamp" },
        { "level": "WARN", "message_contains": "Out-of-order" },
        { "message_contains": "UNKNOWN" },
        { "level": "INFO", "message_contains": "lowercase" },
        { "level": "FATAL", "message_contains": "Critical error" },
        { "level": "FATAL", "message_contains": "System halted" }
      ]
    },
    {
      "name": "Multi-line and Stack Trace Variants",
      "description": "Logs with stack traces (unusual indentation, missing headers), and multi-line logs with embedded JSON.",
      "lines": [
        "2024-06-01 12:00:00 ERROR Exception in thread main",
        "    at com.example.Main.main(Main.java:14)",
        "    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)",
        "    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)",
        "Caused by: java.lang.NullPointerException",
        "    at com.example.Helper.help(Helper.java:8)",
        "2024-06-01 12:01:00 ERROR Another error",
        "{\"timestamp\":\"2024-06-01T12:01:01Z\",\"level\":\"ERROR\",\"message\":\"Embedded JSON error\"}",
        "2024-06-01 12:02:00 INFO Start of multi-line log",
        "Continued message part 1",
        "Continued message part 2"
      ],
      "expect": [
        { "level": "ERROR", "message_contains": "Exception in thread main" },
        { "message_contains": "at com.example.Main.main" },
        { "message_contains": "at sun.reflect.NativeMethodAccessorImpl.invoke0" },
        { "message_contains": "at sun.reflect.NativeMethodAccessorImpl.invoke" },
        { "message_contains": "Caused by: java.lang.NullPointerException" },
        { "message_contains": "at com.example.Helper.help" },
        { "level": "ERROR", "message_contains": "Another error" },
        { "level": "ERROR", "message_contains": "Embedded JSON error" },
        { "level": "INFO", "message_contains": "multi-line log" },
        { "message_contains": "Continued message part 1" }
      ]
    },
    {
      "name": "Real-World Ugly Logs",
      "description": "Logs with ANSI color codes, shell escape sequences, and control characters.",
      "lines": [
        "\u001b[31m2024-06-01 12:00:00 ERROR Red colored error\u001b[0m",
        "2024-06-01 12:01:00 INFO Normal log entry",
        "2024-06-01 12:02:00 WARN \u001b[33mYellow warning\u001b[0m",
        "2024-06-01 12:03:00 INFO Log with shell escape: $(rm -rf /)",
        "2024-06-01 12:04:00 INFO Control char: \u0001\u0002\u0003",
        "2024-06-01 12:05:00 DEBUG \u001b[32mGreen debug\u001b[0m"
      ],
      "expect": [
        { "level": "ERROR", "message_contains": "Red colored error" },
        { "level": "INFO", "message_contains": "Normal log entry" },
        { "level": "WARN", "message_contains": "Yellow warning" },
        { "level": "INFO", "message_contains": "shell escape" },
        { "message_contains": "Control char" },
        { "level": "DEBUG", "message_contains": "Green debug" }
      ]
    },
    {
      "name": "Large Log File",
      "description": "Large log file with 10000 lines",
      "lines": [
        "2024-06-01 12:00:00 INFO Line 1",
        "2024-06-01 12:00:01 INFO Line 2",
        "2024-06-01 12:00:02 INFO Line 3",
        "2024-06-01 12:00:03 INFO Line 4",
        "2024-06-01 12:00:04 INFO Line 5",
        "2024-06-01 12:00:05 INFO Line 6",
        "2024-06-01 12:00:06 INFO Line 7",
        "2024-06-01 12:00:07 INFO Line 8",
        "2024-06-01 12:00:08 INFO Line 9",  
        "2024-06-01 12:00:09 INFO Line 10"
      ],
      "expect": [
        { "level": "INFO", "message_contains": "Line 1" },
        { "level": "INFO", "message_contains": "Line 2" },
        { "level": "INFO", "message_contains": "Line 3" },
        { "level": "INFO", "message_contains": "Line 4" },
        { "level": "INFO", "message_contains": "Line 5" },
        { "level": "INFO", "message_contains": "Line 6" },
        { "level": "INFO", "message_contains": "Line 7" },
        { "level": "INFO", "message_contains": "Line 8" },
        { "level": "INFO", "message_contains": "Line 9" },
        { "level": "INFO", "message_contains": "Line 10" }
      ]
    },
    {
      "name": "Sample Logs 3",
      "description": "A complex mix of different log formats from sample-logs-3.txt with exact content validation",
      "log_file": "sample-logs-3.txt",
      "limit": 100,
      "expect": [
        {
          "timestamp": "2024-07-01T08:00:00.000Z",
          "level": "ERROR",
          "message": "UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte",
          "metadata": {
            "pid": "202",
            "tid": "7074"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:01.000Z",
          "level": "WARN",
          "message": "Request started: /login",
          "metadata": {
            "pid": "2126",
            "req_id": "ee864433",
            "trace": "07872b04-3975-4cc3-83cf-5600a4d4f54f"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:02.000Z",
          "level": "WARN",
          "message": "External API call failed: status=401",
          "metadata": {
            "pid": "1383",
            "req_id": "3d2b9177",
            "trace": "25a933a9-c325-4837-872c-b87173baf995"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:03.000Z",
          "level": "INFO",
          "message": "Completed 404 in 716ms for 72.40.56.246",
          "metadata": {
            "pid": "4315",
            "req_id": "768a9000",
            "trace": "c16ab3fd-bac0-4b68-ac7f-b735a5164eb1"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:04.000Z",
          "level": "ERROR",
          "message": "External API call failed: status=502",
          "metadata": {
            "pid": "2470",
            "req_id": "e0b87cae",
            "trace": "ab307509-c32d-4d3e-aaff-fd6e818a8531"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:05.000Z",
          "level": "ERROR",
          "message": "SELECT * FROM reports WHERE date=%s disk I/O error",
          "metadata": {}
        },
        {
          "timestamp": "2024-07-01T08:00:06.000Z",
          "level": "WARN",
          "message": "Session expired for user 2989",
          "metadata": {
            "pid": "1187",
            "req_id": "9ced2110",
            "trace": "2b46c3b1-0046-4131-a39c-e06b63e73a65"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:07.000Z",
          "level": null,
          "message": "91.54.172.69 - - GET /api/v1/orders HTTP/1.1 503 1521 - Go-http-client/1.1 X-Request-ID: a2f4858c",
          "metadata": {}
        },
        {
          "timestamp": "2024-07-01T08:00:08.000Z",
          "level": "WARN",
          "message": "Request started: /api/v1/products",
          "metadata": {
            "pid": "3187",
            "req_id": "33afd9e4",
            "trace": "7ba33aef-6812-45a4-be6d-1efdeb21249c"
          }
        },
        {
          "timestamp": "2024-07-01T08:00:09.000Z",
          "level": "ERROR",
          "message": "Cache miss for key 'user_profile_3242'",
          "metadata": {
            "pid": "4297",
            "req_id": "94b17195",
            "trace": "abf17670-886e-4f23-be9c-68367ada8412"
          }
        }
      ]
    }
  ],
  "microservice_test_cases": [
    {
      "name": "Simple syslog",
      "description": "Basic syslog format test for microservice",
      "content": "2024-06-01 12:00:00 INFO System startup completed\n2024-06-01 12:01:00 ERROR Disk full\n2024-06-01 12:02:00 WARN High memory usage: 85%",
      "expected_fields": [
        "timestamp",
        "level",
        "message"
      ]
    },
    {
      "name": "Apache access log",
      "description": "Apache access log test for microservice",
      "content": "127.0.0.1 - - [01/Jun/2024:12:00:00 +0000] \"GET /index.html HTTP/1.1\" 200 2326\n127.0.0.1 - - [01/Jun/2024:12:01:00 +0000] \"POST /login HTTP/1.1\" 401 512\n127.0.0.1 - - [01/Jun/2024:12:02:00 +0000] \"GET /api/data HTTP/1.1\" 500 890",
      "expected_fields": [
        "message",
        "metadata"
      ]
    },
    {
      "name": "JSON logs",
      "description": "JSON logs test for microservice",
      "content": "{\"timestamp\":\"2024-06-01T12:00:00Z\",\"level\":\"INFO\",\"message\":\"System started\",\"user\":\"admin\"}\n{\"timestamp\":\"2024-06-01T12:01:00Z\",\"level\":\"WARN\",\"message\":\"High memory usage\",\"memory_percent\":85}\n{\"timestamp\":\"2024-06-01T12:02:00Z\",\"level\":\"ERROR\",\"message\":\"Database error\",\"error_code\":\"DB001\"}",
      "expected_fields": [
        "timestamp",
        "level",
        "message",
        "metadata"
      ]
    },
    {
      "name": "Docker logs",
      "description": "Docker container logs test for microservice",
      "content": "2024-06-01T12:00:00.123Z container1 INFO Container started successfully\n2024-06-01T12:01:00.456Z container2 WARN High CPU usage: 90%\n2024-06-01T12:02:00.789Z container3 ERROR Out of memory exception",
      "expected_fields": [
        "timestamp",
        "level",
        "message"
      ]
    },
    {
      "name": "Unstructured error logs",
      "description": "Unstructured error logs test for microservice",
      "content": "Something went wrong at 12:00:00!\nCritical failure in module X\nDatabase connection timeout\nStack trace: java.lang.Exception: Connection failed",
      "expected_fields": [
        "message"
      ]
    },
    {
      "name": "Mixed content (JSON + unstructured)",
      "description": "Mixed content test for microservice",
      "content": "{\"timestamp\":\"2024-06-01T12:00:00Z\",\"level\":\"INFO\",\"message\":\"JSON entry\"}\n2024-06-01 12:00:01 ERROR Unstructured entry\n{\"timestamp\":\"2024-06-01T12:00:02Z\",\"level\":\"WARN\",\"message\":\"Another JSON\"}\n2024-06-01 12:00:03 INFO Another unstructured",
      "expected_fields": [
        "timestamp",
        "level",
        "message"
      ]
    },
    {
      "name": "Sample Logs 3 Large Mixed File (first 100 lines)",
      "description": "Test large, mixed-format log file (sample-logs-3.txt, first 100 lines)",
      "content": "2024-07-01T08:00:00.000 [ error ] [pid 202:tid 7074] UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte\n2024-07-01T08:00:01.000 | WARN | pid=2126 | req_id=ee864433 | trace=07872b04-3975-4cc3-83cf-5600a4d4f54f | Request started: /login\n2024-07-01T08:00:02.000 | WARN | pid=1383 | req_id=3d2b9177 | trace=25a933a9-c325-4837-872c-b87173baf995 | External API call failed: status=401\n2024-07-01T08:00:03.000 | INFO | pid=4315 | req_id=768a9000 | trace=c16ab3fd-bac0-4b68-ac7f-b735a5164eb1 | Completed 404 in 716ms for 72.40.56.246\n2024-07-01T08:00:04.000 | ERROR | pid=2470 | req_id=e0b87cae | trace=ab307509-c32d-4d3e-aaff-fd6e818a8531 | External API call failed: status=502\n2024-07-01T08:00:05.000 ERROR: SELECT * FROM reports WHERE date=%s disk I/O error\n2024-07-01T08:00:06.000 | WARN | pid=1187 | req_id=9ced2110 | trace=2b46c3b1-0046-4131-a39c-e06b63e73a65 | Session expired for user 2989\n91.54.172.69 - - [2024-07-01T08:00:07.000 +0000] \"GET /api/v1/orders HTTP/1.1\" 503 1521 \"-\" \"Go-http-client/1.1\" \"X-Request-ID: a2f4858c\"\n2024-07-01T08:00:08.000 | WARN | pid=3187 | req_id=33afd9e4 | trace=7ba33aef-6812-45a4-be6d-1efdeb21249c | Request started: /api/v1/products\n2024-07-01T08:00:09.000 | ERROR | pid=4297 | req_id=94b17195 | trace=abf17670-886e-4f23-be9c-68367ada8412 | Cache miss for key 'user_profile_3242'\n2024-07-01T08:00:10.000 WARNING: INSERT INTO sessions (user_id, token) VALUES (%s, %s)\n2024-07-01T08:00:11.000 [INFO] trace=bfc5aa5b-5dfa-45a4-b773-dfae281f7faf Job 228261c640b5 is being retried (attempt 3)\n2024-07-01T08:00:12.000 | ERROR | pid=3299 | req_id=15543022 | trace=9c942dfd-2608-4333-b30d-0878ad88aa76 | Request started: /api/v1/report\n2024-07-01T08:00:13.000 [ warn ] [pid 2670:tid 2310] TimeoutError: operation timed out after 30000ms\n203.175.109.153 - - [2024-07-01T08:00:14.000 +0000] \"GET /api/v1/orders HTTP/1.1\" 404 5001 \"-\" \"python-requests/2.23.0\" \"X-Request-ID: 14e10ab4\"\n2024-07-01T08:00:15.000 WARNING: SELECT COUNT(*) FROM visits WHERE date=%s\n2024-07-01T08:00:16.000 | INFO | pid=4977 | req_id=648aa232 | trace=ebaff5d4-1548-4071-8aab-d932fbef7bde | User authentication failed for token fa1f86ed\n2024-07-01T08:00:17.000 | INFO | pid=2858 | req_id=e8a51f15 | trace=59096902-9623-4ba8-b073-35a33a30758b | User authentication failed for token da58a0a2\n2024-07-01T08:00:18.000 | WARN | pid=2531 | req_id=30c28041 | trace=7f9c55a1-511d-40c8-90d7-60ddf57eb98a | Database query: SELECT * FROM users WHERE id = %s\n2024-07-01T08:00:19.000 | WARN | pid=1237 | req_id=2b5c38da | trace=27aa66ec-2d98-43f1-9831-1a5ce7ef2dc2 | User authentication failed for token 5786586b\n2024-07-01T08:00:20.000 FATAL: SELECT * FROM products WHERE id=%s database is locked\n238.139.194.187 - - [2024-07-01T08:00:21.000 +0000] \"GET /login HTTP/1.1\" 401 3179 \"-\" \"python-requests/2.23.0\" \"X-Request-ID: d64c023c\"\n2024-07-01T08:00:22.000 [ERROR] trace=131be0ab-c433-4ce0-8cab-affb5a956240 Job 8a11e39d9664 picked up for processing\n2024-07-01T08:00:23.000 | WARN | pid=2015 | req_id=4669df79 | trace=817d6806-e915-4768-a400-2cf1f2a624cc | Database query: DELETE FROM cart WHERE user_id=%s\n2024-07-01T08:00:24.000 | INFO | pid=1276 | req_id=835eeeab | trace=a8afdfe8-93f8-44fe-a114-4d253050ac14 | Cache miss for key 'user_profile_4678'\n2024-07-01T08:00:25.000 FATAL: DELETE FROM cart WHERE user_id=%s out of memory\n2024-07-01T08:00:26.000 [ error ] [pid 497:tid 6398] FileNotFoundError: [Errno 2] No such file or directory\n2024-07-01T08:00:27.000 | ERROR | pid=2765 | req_id=aa3db72c | trace=072ccc06-8f31-41ae-bd6b-05770688f80f | Completed 404 in 976ms for 222.187.14.173\n64.50.49.138 - - [2024-07-01T08:00:28.000 +0000] \"GET /metrics HTTP/1.1\" 200 1623 \"-\" \"python-requests/2.23.0\" \"X-Request-ID: 629d621c\"\n2024-07-01T08:00:29.000 | DEBUG | pid=2140 | req_id=987179fe | trace=596ba0c5-d54e-46fd-95e7-bd0575df497c | Completed 200 in 927ms for 207.221.220.141\n2024-07-01T08:00:30.000 ERROR: DELETE FROM cart WHERE user_id=%s out of memory\n2024-07-01T08:00:31.000 | DEBUG | pid=2989 | req_id=3956cacc | trace=285df818-313f-43f1-9ebd-71b131312d6b | Worker processed job 822198\n2024-07-01T08:00:32.000 | DEBUG | pid=3853 | req_id=718b7def | trace=7a87aeb8-e502-448a-9dc0-dbc6e3f9825a | Cache miss for key 'user_profile_411'\n2024-07-01T08:00:33.000 [WARN] trace=f1ad99ce-11de-4096-b5b7-4a971102cb84 Job 8c919d59cf9b picked up for processing\n2024-07-01T08:00:34.000 | INFO | pid=4935 | req_id=86bafae5 | trace=2e907f28-861c-4d9b-a3ed-be634b0b007b | Request started: /api/v1/products\n159.21.108.169 - - [2024-07-01T08:00:35.000 +0000] \"GET /api/v1/report HTTP/1.1\" 503 2711 \"-\" \"Apache-HttpClient/4.5.12 (Java/1.8.0_181)\" \"X-Request-ID: 961078ec\"\n2024-07-01T08:00:36.000 | ERROR | pid=4828 | req_id=a8c905f5 | trace=bac6da4d-fc0a-427b-91e5-1a40a8a70e4c | Completed 504 in 1486ms for 81.62.68.102\n2024-07-01T08:00:37.000 | DEBUG | pid=1038 | req_id=10fde677 | trace=aecf42bd-bec5-4f56-aff6-bf5ce382fcdf | Database query: SELECT * FROM products WHERE id=%s\n2024-07-01T08:00:38.000 | ERROR | pid=2513 | req_id=546adc0f | trace=9af537e9-bbd6-4e0f-ac4b-96ef7b0d3dbd | User authentication failed for token 019209d5\n2024-07-01T08:00:39.000 [ error ] [pid 538:tid 7081] AssertionError: Expected status code 200 but got 503\n2024-07-01T08:00:40.000 WARNING: INSERT INTO sessions (user_id, token) VALUES (%s, %s)\n2024-07-01T08:00:41.000 | WARN | pid=2154 | req_id=a1868af8 | trace=a47365b1-55ca-485c-9a74-6737a202b84a | Worker processed job 2feb2d\n213.71.12.1 - - [2024-07-01T08:00:42.000 +0000] \"GET /static/css/main.css HTTP/1.1\" 200 2265 \"-\" \"Go-http-client/1.1\" \"X-Request-ID: 32eb30df\"\n2024-07-01T08:00:43.000 | DEBUG | pid=1661 | req_id=192e8c55 | trace=da01450c-470f-4e24-8ad3-63731129d171 | User authentication failed for token 08f20239\n2024-07-01T08:00:44.000 [ERROR] trace=d48d43f1-3d4c-4e82-b29a-07bafb64fdc2 Job 6d4df8b505ce picked up for processing\n2024-07-01T08:00:45.000 WARNING: SELECT * FROM products WHERE id=%s\n2024-07-01T08:00:46.000 | INFO | pid=4682 | req_id=82d441bf | trace=cea1b8e5-edf2-4ee4-834a-e538722e24b0 | User authentication failed for token 8ea6ac17\n2024-07-01T08:00:47.000 | WARN | pid=4998 | req_id=7dc2d41d | trace=29f8f688-5f9c-464a-a6f1-7fbd39e3a134 | Completed 200 in 387ms for 189.237.86.201\n2024-07-01T08:00:48.000 | INFO | pid=2566 | req_id=039360b2 | trace=4265162b-6d3b-4882-add4-7224995361c5 | Database query: SELECT * FROM products WHERE id=%s\n103.85.72.222 - - [2024-07-01T08:00:49.000 +0000] \"GET /api/v1/orders HTTP/1.1\" 401 4293 \"-\" \"PostmanRuntime/7.29.0\" \"X-Request-ID: 7f76f24d\"\n2024-07-01T08:00:50.000 WARNING: UPDATE users SET last_login=NOW() WHERE id=%s\n2024-07-01T08:00:51.000 | INFO | pid=4847 | req_id=5b9d171b | trace=9a5e32c9-2b22-444f-8855-08e23e3d5a92 | Session expired for user 4888\n2024-07-01T08:00:52.000 [ alert ] [pid 2583:tid 5189] ConnectionRefusedError: [Errno 111] Connection refused\n2024-07-01T08:00:53.000 | DEBUG | pid=1473 | req_id=f7e02262 | trace=9e327394-80e4-43ed-af5b-02591ef4b5c8 | Session expired for user 3534\n2024-07-01T08:00:54.000 | ERROR | pid=3552 | req_id=c91ab5b4 | trace=6ebbe237-c3c1-4092-b82e-1a6b672e7791 | Database query: UPDATE users SET last_login=NOW() WHERE id=%s\n2024-07-01T08:00:55.000 [ERROR] trace=bcdbd52c-57ab-46d3-bbac-22d544615e16 Job fcc92dd406c1 is being retried (attempt 5)\n192.232.45.158 - - [2024-07-01T08:00:56.000 +0000] \"GET /api/v1/report HTTP/1.1\" 401 4608 \"-\" \"python-requests/2.23.0\" \"X-Request-ID: 413a4725\"\n2024-07-01T08:00:57.000 | INFO | pid=4414 | req_id=0652d98e | trace=2c07f946-632b-4d2f-9217-2c9ac7f0dbcb | Database query: SELECT * FROM reports WHERE date=%s\n2024-07-01T08:00:58.000 | DEBUG | pid=3093 | req_id=4a965c59 | trace=4e98dead-c900-4049-8821-0f2c9a7b0039 | Database query: SELECT * FROM reports WHERE date=%s\n2024-07-01T08:00:59.000 | WARN | pid=4303 | req_id=070654f2 | trace=41a8746c-17b5-4a89-8fd6-b711a75a0b19 | Database query: UPDATE orders SET status='PAID' WHERE id=%s\n2024-07-01T08:01:00.000 FATAL: UPDATE users SET last_login=NOW() WHERE id=%s out of memory",
      "expected_fields": ["timestamp", "level", "message", "metadata"]
    }
  ],
  "real_world_scenarios": [
    {
      "name": "Web Application Logs",
      "description": "Typical web application logs with user actions, errors, and performance metrics",
      "lines": [
        "2024-06-01 12:00:00 INFO [UserService] User login successful: user_id=12345, ip=192.168.1.100",
        "2024-06-01 12:00:01 INFO [OrderService] Order created: order_id=67890, user_id=12345, amount=299.99",
        "2024-06-01 12:00:02 WARN [PaymentService] Payment processing slow: order_id=67890, duration=5.2s",
        "2024-06-01 12:00:03 ERROR [DatabaseService] Connection timeout: retry_attempt=3, error_code=DB_TIMEOUT",
        "2024-06-01 12:00:04 INFO [EmailService] Order confirmation sent: order_id=67890, email=user@example.com"
      ]
    },
    {
      "name": "Microservices Communication",
      "description": "Logs from microservices communicating with each other",
      "lines": [
        "2024-06-01 12:00:00 INFO [API-Gateway] Request received: method=POST, path=/api/orders, client_ip=10.0.0.1",
        "2024-06-01 12:00:01 INFO [Auth-Service] Token validated: user_id=12345, permissions=[read,write]",
        "2024-06-01 12:00:02 INFO [Order-Service] Order validation passed: order_id=67890",
        "2024-06-01 12:00:03 INFO [Inventory-Service] Stock check completed: product_id=ABC123, available=true",
        "2024-06-01 12:00:04 ERROR [Payment-Service] Payment gateway timeout: order_id=67890, provider=stripe"
      ]
    },
    {
      "name": "System Administration",
      "description": "System administration and monitoring logs",
      "lines": [
        "2024-06-01 12:00:00 INFO [SystemMonitor] CPU usage: 45%, Memory: 67%, Disk: 23%",
        "2024-06-01 12:00:01 WARN [BackupService] Backup job running longer than expected: duration=45m, expected=30m",
        "2024-06-01 12:00:02 INFO [SecurityScanner] Vulnerability scan completed: issues_found=2, severity=medium",
        "2024-06-01 12:00:03 ERROR [NetworkMonitor] High latency detected: avg_latency=150ms, threshold=100ms",
        "2024-06-01 12:00:04 INFO [UpdateService] System update available: version=2.1.0, security_patches=3"
      ]
    }
  ]
}